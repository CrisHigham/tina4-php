<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.20"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Tina4 - This is not a framework: howdoi</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="Tina4.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Tina4 - This is not a framework
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.20 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">howdoi </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><h1><a class="anchor" id="autotoc_md53"></a>
How do I?</h1>
<p>This is a guide for doing things in the <a class="el" href="namespace_tina4.html">Tina4</a> environment which will hopefully make your journey easier.</p>
<h2><a class="anchor" id="autotoc_md54"></a>
Create a basic landing page</h2>
<h2><a class="anchor" id="autotoc_md55"></a>
Connect to a database</h2>
<p>There are 3 database engines currently supported, we are happy to add more if required but for now they are:</p>
<ul>
<li>Firebird</li>
<li>MySQL</li>
<li>SQLite</li>
</ul>
<p>The database connection is established in a global variable called <code>$DBA</code> in the index.php file for convenience, you could put it anywhere as long as it is global and required before any database functionality is required. For testing purpose, you can use the SQLite database type below.</p>
<h3><a class="anchor" id="autotoc_md56"></a>
Examples:</h3>
<p>Notice the convention of using the <code>hostname:[database|database-path]</code> except when it is SQLite which then becomes the local path.</p>
<p>For MySQL database type: </p><div class="fragment"><div class="line">&lt;?php</div>
<div class="line"> </div>
<div class="line">global $DBA;</div>
<div class="line"> </div>
<div class="line"><span class="comment">//MySQL</span></div>
<div class="line">$DBA = new \Tina4\DataMySQL(<span class="stringliteral">&quot;localhost:somedatabase&quot;</span>, DB_USERNAME, DB_PASSWORD, <span class="stringliteral">&quot;d/m/Y&quot;</span>);</div>
</div><!-- fragment --><p>For Firebird database type: </p><div class="fragment"><div class="line">&lt;?php</div>
<div class="line"> </div>
<div class="line">global $DBA;</div>
<div class="line"> </div>
<div class="line"><span class="comment">//Firebird </span></div>
<div class="line">$DBA = new \Tina4\DataFirebird(<span class="stringliteral">&quot;localhost:/home/database/FIREBIRD.DB&quot;</span>, <span class="stringliteral">&quot;sysdba&quot;</span>, <span class="stringliteral">&quot;masterkey&quot;</span>);</div>
</div><!-- fragment --><p>For SQLite database type: </p><div class="fragment"><div class="line">&lt;?php</div>
<div class="line"> </div>
<div class="line">global $DBA;</div>
<div class="line"> </div>
<div class="line"><span class="comment">//SQLite</span></div>
<div class="line">$DBA = new \Tina4\DataSQLite3(<span class="stringliteral">&quot;/home/someplace/my.db&quot;</span>);</div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md57"></a>
Create a table/migration</h2>
<p>You want to create a table for the database? Before you continue,please ensure you have a "migration" folder e.g. C:/yourprojectfolder/migration</p>
<h3><a class="anchor" id="autotoc_md58"></a>
Example</h3>
<div class="fragment"><div class="line">Spin up a web server to view your porject on your web broser. Do this by running &quot;php -S localhost:7145 index.php&quot; in command terminal.</div>
<div class="line">Once running you must add /migrate/create into your browser URL.</div>
<div class="line">Create your table and click &quot;Create Table&quot;.</div>
<div class="line">You will be shown that the migration was created and a SQL file with the table you just created will be in the migration folder.  </div>
</div><!-- fragment --><p><img src="../assets/images/migrate.png" alt="alt text" class="inline"/></p>
<h2><a class="anchor" id="autotoc_md59"></a>
Build a class with database access</h2>
<p>By default we have a global <code>$DBA</code> variable and it will get passed into your class if you extend <code>\<a class="el" href="namespace_tina4.html">Tina4</a>\Data</code>. It is advised to store these classes in the app folder.</p>
<h3><a class="anchor" id="autotoc_md60"></a>
Example:</h3>
<div class="fragment"><div class="line">&lt;?php</div>
<div class="line"> </div>
<div class="line"><span class="keyword">class </span>MyDBActiveObject <span class="keyword">extends</span> <a class="code" href="class_tina4_1_1_data.html">\Tina4\Data</a></div>
<div class="line">{</div>
<div class="line">    <span class="keyword">function</span> queryTheDB () {</div>
<div class="line">        <span class="keywordflow">return</span> $this-&gt;DBA-&gt;fetch(<span class="stringliteral">&#39;select * from table&#39;</span>)-&gt;AsArray();</div>
<div class="line">    }   </div>
<div class="line"> </div>
<div class="line">}</div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md61"></a>
Save a record using the ORM</h2>
<p>The <a href="https://en.wikipedia.org/wiki/Object-relational_mapping">ORM</a> in <a class="el" href="namespace_tina4.html">Tina4</a> tries to be as light as possible on coding, the basic form uses the object name to map to the table and assumes the first public variable you declare is the primary key. It is required to extend the <code>\<a class="el" href="namespace_tina4.html">Tina4</a>\ORM</code> class to make the magic happen.</p>
<h3><a class="anchor" id="autotoc_md62"></a>
Examples:</h3>
<div class="fragment"><div class="line">&lt;?php</div>
<div class="line"> </div>
<div class="line"><span class="comment">//we need a class extending the ORM</span></div>
<div class="line"><span class="keyword">class </span>User <span class="keyword">extends</span> <a class="code" href="class_tina4_1_1_o_r_m.html">\Tina4\ORM</a> { <span class="comment">//assumes we have a table user in the database</span></div>
<div class="line">    <span class="keyword">public</span> $id; <span class="comment">//primary key because it is first</span></div>
<div class="line">    <span class="keyword">public</span> $name; <span class="comment">//some additional data</span></div>
<div class="line">}   </div>
<div class="line"> </div>
<div class="line">$user = (<span class="keyword">new</span> User());</div>
<div class="line">$user-&gt;name = <span class="stringliteral">&quot;Test Save&quot;</span>;</div>
<div class="line">$user-&gt;save();</div>
<div class="line"> </div>
<div class="line"><span class="comment">//We want the table to be made for us</span></div>
<div class="line"><span class="keyword">class </span>NewTable <span class="keyword">extends</span> <a class="code" href="class_tina4_1_1_o_r_m.html">\Tina4\ORM</a> { <span class="comment">//will be created as newtable in the database</span></div>
<div class="line"><span class="comment"></span>    <span class="keyword">public</span> $id; <span class="comment">//primary key because it is first</span></div>
<div class="line"><span class="comment"></span>    <span class="keyword">public</span> $name; <span class="comment">//some additional data</span></div>
<div class="line">} </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">$newTable = (<span class="keyword">new</span> NewTable());</div>
<div class="line">$newTable-&gt;name = <span class="stringliteral">&quot;Test Save&quot;</span>;</div>
<div class="line">$user-&gt;save();</div>
<div class="line"> </div>
<div class="line"><span class="comment">//How about some thing else</span></div>
<div class="line"> </div>
<div class="line">$newTable = (<span class="keyword">new</span> NewTable(<span class="stringliteral">&#39;{&quot;name&quot;:&quot;TEST&quot;}&#39;</span>));</div>
<div class="line">$newTable-&gt;save();</div>
<div class="line"> </div>
<div class="line"><span class="comment">//Or something else</span></div>
<div class="line"> </div>
<div class="line">$fields = [<span class="stringliteral">&quot;name&quot;</span> =&gt; <span class="stringliteral">&quot;Testing&quot;</span>];</div>
<div class="line">$newTable = (<span class="keyword">new</span> NewTable($fields));</div>
<div class="line">$newTable-&gt;save();</div>
<div class="line"> </div>
<div class="line"><span class="comment">//Or something else - request variable should obviously contain fields that match the class declared</span></div>
<div class="line">$newTable = (<span class="keyword">new</span> NewTable($_REQUEST));</div>
<div class="line">$newTable-&gt;save();</div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md63"></a>
Map my ORM object to a table with another name</h2>
<p>Well we did expect you would ask this question</p>
<h3><a class="anchor" id="autotoc_md64"></a>
Example:</h3>
<div class="fragment"><div class="line"><span class="keyword">class </span>User <span class="keyword">extends</span> <a class="code" href="class_tina4_1_1_o_r_m.html">\Tina4\ORM</a> { <span class="comment">//assumes we have a table user in the database</span></div>
<div class="line">    <span class="keyword">public</span> $tableName=<span class="stringliteral">&quot;my_weird_database_table&quot;</span>; <span class="comment">//will make sure this object gets data to and from this table    </span></div>
<div class="line">    <span class="keyword">public</span> $id; <span class="comment">//primary key because it is first</span></div>
<div class="line">    <span class="keyword">public</span> $name; <span class="comment">//some additional data</span></div>
<div class="line">}   </div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md65"></a>
Map my ORM field to a database field which doesn't follow the Tina4 pattern</h2>
<h3><a class="anchor" id="autotoc_md66"></a>
Example:</h3>
<div class="fragment"><div class="line">&lt;?php</div>
<div class="line"> </div>
<div class="line"><span class="keyword">public</span> $fieldMapping = [</div>
<div class="line">    <span class="stringliteral">&quot;id&quot;</span> =&gt; <span class="stringliteral">&quot;ID&quot;</span>,</div>
<div class="line">    <span class="stringliteral">&quot;code&quot;</span> =&gt; <span class="stringliteral">&quot;CODE&quot;</span>,       </div>
<div class="line">    <span class="stringliteral">&quot;name&quot;</span> =&gt; <span class="stringliteral">&quot;NAME&quot;</span>];</div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md67"></a>
Annotate my REST for swagger</h2>
<p>Its good to explain how one component is dependant on another.</p>
<h3><a class="anchor" id="autotoc_md68"></a>
Example:</h3>
<div class="fragment"><div class="line">&lt;?php</div>
<div class="line"> </div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md69"></a>
Secure a REST end point</h2>
<p>As easy as adding @secure in your annotation</p>
<h3><a class="anchor" id="autotoc_md70"></a>
Example:</h3>
<div class="fragment"><div class="line">&lt;?php</div>
<div class="line"> </div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md71"></a>
Add a filter to process records when they are extracted from the database</h2>
<p>Lets say you want to filter the database for all the entries with the first name "Peter":</p>
<p><a class="anchor" id="autotoc_md72"></a></p><h5>Example:</h5>
<div class="fragment"><div class="line">&lt;?php</div>
<div class="line"> </div>
<div class="line">$sql = <span class="stringliteral">&quot;SELECT *   </span></div>
<div class="line"><span class="stringliteral">          FROM MyGuests</span></div>
<div class="line"><span class="stringliteral">         WHERE first_name=&#39;Peter&#39;&quot;</span>;</div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md73"></a>
Exclude some fields from being displayed on REST result or query</h2>
<h3><a class="anchor" id="autotoc_md74"></a>
Example:</h3>
<div class="fragment"><div class="line"><span class="keyword">class </span>User <span class="keyword">extends</span> <a class="code" href="class_tina4_1_1_o_r_m.html">\Tina4\ORM</a> { <span class="comment">//assumes we have a table user in the database</span></div>
<div class="line">    <span class="keyword">public</span> $id; <span class="comment">//primary key because it is first</span></div>
<div class="line">    <span class="keyword">public</span> $name; <span class="comment">//some additional data</span></div>
<div class="line">    <span class="keyword">public</span> $excludeFields = <span class="stringliteral">&quot;password,myId&quot;</span>;</div>
<div class="line">}   </div>
<div class="line"> </div>
<div class="line"><span class="keyword">class </span>OtherUser <span class="keyword">extends</span> <a class="code" href="class_tina4_1_1_o_r_m.html">\Tina4\ORM</a> { <span class="comment">//assumes we have a table user in the database</span></div>
<div class="line">    <span class="keyword">public</span> $id; <span class="comment">//primary key because it is first</span></div>
<div class="line">    <span class="keyword">public</span> $name; <span class="comment">//some additional data</span></div>
<div class="line">    <span class="keyword">public</span> $excludeFields = [<span class="stringliteral">&quot;password&quot;</span>,<span class="stringliteral">&quot;myId&quot;</span>];</div>
<div class="line">}   </div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md75"></a>
Query the database for some records</h2>
<div class="fragment"><div class="line">&lt;?php</div>
<div class="line"> </div>
<div class="line">$sql = <span class="stringliteral">&quot;SELECT *   </span></div>
<div class="line"><span class="stringliteral">          FROM MyGuests</span></div>
<div class="line"><span class="stringliteral">         WHERE first_name=&#39;Peter&#39;&quot;</span>;</div>
<div class="line">$result = $conn-&gt;query($sql);</div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md76"></a>
Get an array of ORM objects</h2>
<p>Given that you have an object extending \Tina4\ORM it will get "magical powers", namely the ability to create, load &amp; save</p>
<h2><a class="anchor" id="autotoc_md77"></a>
Add a REST end point</h2>
<p>The REST end point is easily added, with an anonymous method to handle the request, the anonymous method should have the response variable. The request exposes more information which comes from the browser, in the case of parameters passed to it. You should always return the <code>$response</code> object!;</p>
<h3><a class="anchor" id="autotoc_md78"></a>
Examples</h3>
<div class="fragment"><div class="line"><span class="comment">//Standard</span></div>
<div class="line">\Tina4\Get::add(<span class="stringliteral">&quot;/hello/world&quot;</span>, <span class="keyword">function</span>(\<a class="code" href="namespace_tina4.html">Tina4</a>\Response $response, \<a class="code" href="namespace_tina4.html">Tina4</a>\Request $request){  </div>
<div class="line">    <span class="keywordflow">return</span> $response(<span class="stringliteral">&quot;Hello World&quot;</span>, HTTP_OK, TEXT_HTML);</div>
<div class="line">});</div>
<div class="line"> </div>
<div class="line"><span class="comment">//Inline Params</span></div>
<div class="line">\Tina4\Get::add(<span class="stringliteral">&quot;/hello/world/{id}&quot;</span>, <span class="keyword">function</span>($id, \<a class="code" href="namespace_tina4.html">Tina4</a>\Response $response, \<a class="code" href="namespace_tina4.html">Tina4</a>\Request $request){</div>
<div class="line">    <span class="keywordflow">return</span> $response(<span class="stringliteral">&quot;Hello World {$id}&quot;</span>, HTTP_OK, TEXT_HTML);</div>
<div class="line">});</div>
<div class="line"> </div>
<div class="line"><span class="comment">//Other methods you can test</span></div>
<div class="line">\Tina4\Post::add(...);</div>
<div class="line"> </div>
<div class="line">\Tina4\Patch::add(...);</div>
<div class="line"> </div>
<div class="line">\Tina4\Put::add(...);</div>
<div class="line"> </div>
<div class="line">\Tina4\Delete::add(...);</div>
<div class="line"> </div>
<div class="line"><span class="comment">//You guessed it - It takes every method - GET, POST, DELETE, PUT, PATCH, OPTIONS</span></div>
<div class="line">\Tina4\Any::add(...);</div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md79"></a>
Use the same REST end point with two different names</h2>
<p>We really hate to write too much code, a <code>|</code> will separate the different end points</p>
<h3><a class="anchor" id="autotoc_md80"></a>
Example</h3>
<div class="fragment"><div class="line"><span class="comment">//Standard</span></div>
<div class="line">\Tina4\Get::add(<span class="stringliteral">&quot;/hello/world|/hello/wrld&quot;</span>, <span class="keyword">function</span>(\<a class="code" href="namespace_tina4.html">Tina4</a>\Response $response, \<a class="code" href="namespace_tina4.html">Tina4</a>\Request $request){  </div>
<div class="line">    <span class="keywordflow">return</span> $response(<span class="stringliteral">&quot;Hello World&quot;</span>, HTTP_OK, TEXT_HTML);</div>
<div class="line">});</div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md81"></a>
Add my own filters to twig</h2>
<p>If you need to add your own filters in Twig you use the config passed to Tina4Php on running <a class="el" href="namespace_tina4.html">Tina4</a> in the index file</p>
<h3><a class="anchor" id="autotoc_md82"></a>
Examples</h3>
<div class="fragment"><div class="line">$config = <a class="code" href="class_tina4_1_1_config.html">\Tina4\Config</a>();</div>
<div class="line"> </div>
<div class="line">$config-&gt;addFilter(<span class="stringliteral">&quot;myFilter&quot;</span>, <span class="keyword">function</span> ($name) {</div>
<div class="line">    <span class="keywordflow">return</span> str_shuffle($name);</div>
<div class="line">});</div>
<div class="line"> </div>
<div class="line">echo (<span class="keyword">new</span> \<a class="code" href="namespace_tina4.html">Tina4</a>\Tina4Php($config));</div>
</div><!-- fragment --><p>Somewhere in Twig, in a template, far far away ... </p><div class="fragment"><div class="line">&lt;label&gt;{{ &quot;NAME&quot; | myFilter  }}&lt;/label&gt;</div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md83"></a>
Add localized date format</h2>
<p>If you want Tina to get the Users time and date information correct this is how</p>
<h3><a class="anchor" id="autotoc_md84"></a>
Example</h3>
<div class="fragment"><div class="line">&lt;label <span class="keywordflow">for</span>=<span class="stringliteral">&quot;startDate&quot;</span>&gt;Start Date&lt;/label&gt;</div>
<div class="line">&lt;input <span class="keyword">class</span>=<span class="stringliteral">&quot;form-control&quot;</span> type=<span class="stringliteral">&quot;datetime-local&quot;</span> name=<span class="stringliteral">&quot;startDate&quot;</span> placeholder=<span class="stringliteral">&quot;Start Date&quot;</span> value=<span class="stringliteral">&quot;{{ data.startDate | dateValue}}&quot;</span>&gt;</div>
</div><!-- fragment --><p>Go back to how to make a webpage - landing page  or return to <a href="/">Tina4 - This is Not Another Framework</a>. </p>
</div></div><!-- contents -->
</div><!-- PageDoc -->
<div class="ttc" id="anamespace_tina4_html"><div class="ttname"><a href="namespace_tina4.html">Tina4</a></div><div class="ttdef"><b>Definition:</b> Any.php:9</div></div>
<div class="ttc" id="aclass_tina4_1_1_o_r_m_html"><div class="ttname"><a href="class_tina4_1_1_o_r_m.html">Tina4\ORM</a></div><div class="ttdef"><b>Definition:</b> ORM.php:19</div></div>
<div class="ttc" id="aclass_tina4_1_1_data_html"><div class="ttname"><a href="class_tina4_1_1_data.html">Tina4\Data</a></div><div class="ttdef"><b>Definition:</b> Data.php:6</div></div>
<div class="ttc" id="aclass_tina4_1_1_config_html"><div class="ttname"><a href="class_tina4_1_1_config.html">Tina4\Config</a></div><div class="ttdef"><b>Definition:</b> Config.php:6</div></div>
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="http://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.8.20
</small></address>
</body>
</html>
